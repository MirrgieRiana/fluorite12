このドキュメント内では、結合優先度の高い演算子から順に記載されています。

# リテラル

fluorite12において、リテラルは単独で機能する構文や括弧類を指します。

リテラルは演算子の結合において、原子的な性質を持ちます。

## 整数 `123`

1個以上の数字の列は整数リテラルになります。

```shell
$ flc '123'
# 123
```

---

0で始まる数字列であっても常に10進数として解釈されます。

```shell
$ flc '00123'
# 123
```

# 後置演算子

後置演算子は基部の後ろに付与する演算子です。

後置演算子は左優先結合です。

## 前置単項演算子の後置表現 `value.+` ...

すべての前置単項演算子は、 `.` に続けて書く後置演算子のバリエーションが存在します。

以下の組はすべて同じ働きをします。

```
 +A  A.+
 -A  A.-
 ?A  A.?
!!A  A.!!
 !A  A.!
 &A  A.&
$#A  A.$#
$&A  A.$&
$*A  A.$*
```

後置表現を使うと、一部の構文において丸括弧を削減し、可読性を向上できる場合があります。

# 前置演算子

## 文字列化 `&value`

前置 `&` 演算子は、値の文字列表現を得るのに使います。

```shell
$ flc '&[1..3]'
# [1;2;3]
```

---

値の種類ごとの文字列表現は以下の通りです。

- NULLは `NULL` になります。
- 整数値の文字列表現は、その整数値の10進数表現になります。
- TRUEは `TRUE` 、FALSEは `FALSE` になります。
- 文字列の文字列表現は、その文字列自身です。
- 配列の文字列表現は、 `[1;2;3]` のように、 `;` で区切って `[` `]` で囲んだものです。
- オブジェクトの文字列表現は、 `{a:1;b:2}` のように、キーと値を `:` で区切り、そのエントリーを `;` で区切り、全体を `{` `}` で囲んだものです。

---

文字列化の実態は、値のTO_STRINGメソッドを呼び出すことで行われます。

オブジェクトのTO_STRINGメソッドをオーバーライドすることで、文字列化の処理を変更することができます。

```shell
$ flc '&{TO_STRING: this -> "The value is $(this.value)"}{value: 100}'
# The value is 100
```

# パイプ系演算子

パイプ系演算子はストリームを加工することに長けた演算子です。

非常に低い結合優先度を持ち、式に制御構文レベルの構造を与えることもできます。

パイプ系演算子は左優先結合です。

## パイプ `stream | formula`

パイプ演算子 `|` は、左辺のストリームの各値に対して右辺を評価し、そのフラットなストリームを返します。

右辺では、変数 `_` によって左辺の各要素の値を得ることができます。

```shell
$ flc '1 .. 3 | _, _ * 10'
# 1
# 10
# 2
# 20
# 3
# 30
```

---

左辺がストリームでない場合、右辺の返却値はストリームで改めてラッピングされることなく、そのままの型で返されます。

```shell
$ flc '(5 | _ * 10) + 7'
# 57
```

---

右辺に渡される変数は `=>` によって変更できます。

```shell
$ flc '5 | x => x * 10'
# 50
```

## フィルターパイプ `stream ?| predicate`

フィルターパイプはパイプと似通っていますが、右辺の真偽値を評価し、偽のもののみを返します。

```shell
$ flc '[1 .. 5 ?| _ %% 2]'
# [2;4]
```

## 否定フィルターパイプ `stream !| predicate`

否定フィルターパイプはフィルターパイプの否定バージョンです。

```shell
$ flc '[1 .. 5 !| _ %% 2]'
# [1;3;5]
```

## 右実行パイプ `stream >> function`

右実行パイプは、左辺のストリームを右辺の関数の引数に指定して呼び出します。

```shell
$ flc '1 .. 3 >> JOIN["-"]'
# 1-2-3
```

---

この演算子はストリームを扱う関数の実行に便利です。

```shell
$ flc '"1+2+3" >> SPLIT["+"] | +_ * 2 >> JOIN["-"]'
# 2-4-6
```

## 左実行パイプ `function << stream`

左実行パイプは、右実行パイプの左右が逆のバージョンです。

使い方によっては可読性に貢献する可能性を秘めています。

```shell
$ flc 'OUT << "Hello" << "World"; ,'
# Hello
# World
```


